{"version":3,"file":"mpstore.common.js","sources":["../src/utils.js","../src/mixin.js","../src/module.js","../src/diff.js","../src/update.js","../src/time-travel.js","../src/middleware.js","../src/store.js","../src/index.js"],"sourcesContent":["export function warning (message, noError) {\r\n  message = `\\n\\n[MpStore warning]: ${message}\\n\\n`\r\n  if (noError) {\r\n    console.warn(message)\r\n    return\r\n  }\r\n  throw new Error(message)\r\n}\r\n\r\nexport function assert (condition, message) {\r\n  if (!condition) warning(message)\r\n}\r\n\r\nexport function isPrimitive (value) {\r\n  return (\r\n    typeof value === 'string' ||\r\n    typeof value === 'number' ||\r\n    typeof value === 'symbol' ||\r\n    typeof value === 'boolean'\r\n  )\r\n}\r\n\r\nexport function deepFreeze (state) {\r\n  const names = Object.getOwnPropertyNames(state)\r\n  let len = names.length\r\n  while (~len--) {\r\n    const value = state[names[len]]\r\n    if (typeof value === 'object' && value !== null) {\r\n      deepFreeze(value)\r\n    }\r\n  }\r\n  return Object.freeze(state)\r\n}\r\n\r\nexport function mergeState (oldState, newState) {\r\n  return deepFreeze(Object.assign({}, oldState, newState))\r\n}\r\n\r\nexport function mixinMethods (config, methods) {\r\n  for (const key in methods) {\r\n    if (!(key in config)) {\r\n      config[key] = methods[key]\r\n    }\r\n  }\r\n}\r\n\r\n// remove component from depsComponent\r\nexport function remove (list, component) {\r\n  const index = list.findIndex(item => item.component === component)\r\n  if (index > -1) {\r\n    list.splice(index, 1)\r\n  }\r\n}\r\n\r\nexport function callHook (hooks, name, args) {\r\n  if (hooks && typeof hooks[name] === 'function') {\r\n    return hooks[name].apply(hooks, args)\r\n  }\r\n}\r\n\r\nexport function isEmptyObject (obj) {\r\n  for (const k in obj){\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport function mapObject (obj, fn) {\r\n  const destObject = {}\r\n  for (const key in obj) {\r\n    if (obj.hasOwnProperty(key)) {\r\n      destObject[key] = fn(obj[key])\r\n    }\r\n  }\r\n  return destObject\r\n}\r\n\r\nexport function createWraper (target, before, after) {\r\n  return function (...args) {\r\n    let result\r\n\r\n    if (typeof before === 'function') {\r\n      before.apply(this, args)\r\n    }\r\n\r\n    if (typeof target === 'function') {\r\n      result = target.apply(this, args)\r\n    }\r\n\r\n    if (typeof after === 'function') {\r\n      after.apply(this, args)\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n\r\nexport function isPlainObject (obj) {\r\n  if (typeof obj !== 'object' || obj === null) return false\r\n\r\n  const proto = Object.getPrototypeOf(obj)\r\n  if (proto === null) return true\r\n\r\n  let baseProto = proto\r\n  while (Object.getPrototypeOf(baseProto) !== null) {\r\n    baseProto = Object.getPrototypeOf(baseProto)\r\n  }\r\n  return proto === baseProto\r\n}\r\n\r\nexport function clone (value, record = new WeakMap) {\r\n  if (\r\n    value === null ||\r\n    value === undefined ||\r\n    isPrimitive(value) ||\r\n    typeof value === 'function' ||\r\n    value instanceof Date\r\n  ) {\r\n    return value\r\n  }\r\n\r\n  if (record.has(value)) return record.get(value)\r\n\r\n  const result = typeof value.constructor !== 'function'\r\n    ? Object.create(null) \r\n    : new value.constructor()\r\n\r\n  record.set(value, result)\r\n\r\n  for (const key in value) {\r\n    result[key] = clone(value[key], record)\r\n  }\r\n\r\n  return result\r\n}\r\n\r\n// parse simple path\r\nexport function parsePath (path) {\r\n  const segments = path.split('.')\r\n  return function (obj) {\r\n    for (let i = 0, len = segments.length; i < len; i++) {\r\n      if (!obj) return\r\n      obj = obj[segments[i]]\r\n    }\r\n    return obj\r\n  }\r\n}","import { assert } from './utils'\r\n\r\nexport default function (inject) {\r\n  const expandMethods = Object.create(null)\r\n\r\n  if (typeof inject === 'function') {\r\n    const callback = (name, fn) => {\r\n      assert(\r\n        typeof name === 'string',\r\n        `The mixed method name must a string.`,\r\n      )\r\n\r\n      assert(\r\n        typeof fn === 'function',\r\n        'The mixed method is not a function.'\r\n      )\r\n\r\n      assert(\r\n        !(name in expandMethods),\r\n        `The \"${name}\" is exist,`, +\r\n          `Please don't repeat mixin.`\r\n      )\r\n\r\n      expandMethods[name] = fn\r\n    }\r\n\r\n    inject(callback)\r\n  }\r\n  return expandMethods\r\n}","import {\r\n  assert,\r\n  parsePath,\r\n  isPlainObject,\r\n} from './utils'\r\n\r\n// a. can't delete module, if module is created\r\n// b. modules allow nesting\r\nexport const MODULE_FLAG = Symbol('module')\r\n\r\nexport function isModule (m) {\r\n  return isPlainObject(m) && m[MODULE_FLAG] === true\r\n}\r\n\r\nexport function getModule (state, namespace) {\r\n  const module = namespace\r\n    ? parsePath(namespace)(state)\r\n    : state\r\n  return isModule(module) ? module : null\r\n}\r\n\r\nexport function mergeModule (module, partialModule, moduleName, createMsg) {\r\n  const keys = Object.keys(partialModule)\r\n  let len = keys.length\r\n\r\n  // inspect all attribute\r\n  while(~--len) {\r\n    const key = keys[len]\r\n    // when create by reducer\r\n    if (typeof createMsg === 'function') {\r\n      assert(!(key in module), createMsg(key, moduleName))\r\n    } else {\r\n      // when changing by the setter function\r\n      const originItem = module[key]\r\n      const currentPartialItem = partialModule[key]\r\n      const isModuleForOrigin = isModule(originItem)\r\n      const isModuleForCurrent = isModule(currentPartialItem)\r\n\r\n      assert(\r\n        !(isModuleForOrigin && !isModuleForCurrent),\r\n        `The namespace [${key}] is a module that you can change to other value, ` +\r\n          'You can use `createModule` method to recreate a module.' + \r\n            '\\n\\n  --- from setter function.',\r\n      )\r\n      \r\n      // allow merge child module\r\n      if (isModuleForOrigin && isModuleForCurrent) {\r\n        partialModule[key] = mergeModule(originItem, currentPartialItem)\r\n      }\r\n    }\r\n  }\r\n\r\n  return createModule(Object.assign({}, module, partialModule))\r\n}\r\n\r\n// the `__mpModule` flag is not allowed to be traversed\r\nexport function addModuleFlag (obj) {\r\n  obj[MODULE_FLAG] = true\r\n  return obj\r\n}\r\n\r\nexport function createModule (obj) {\r\n  assert(\r\n    isPlainObject(obj),\r\n    'The base module object must be an plain object',\r\n  )\r\n\r\n  if (isModule(obj)) {\r\n    return obj\r\n  }\r\n\r\n  addModuleFlag(obj)\r\n  return obj\r\n}\r\n\r\n// a. if want to define a module, the parent and child modules must be modules.\r\n// demo:\r\n//   store.add('action', {\r\n//     __mpModule: true,\r\n//      childModule: {\r\n//       __mpModule: true,\r\n//     }\r\n//   })\r\n// \r\n// b. if create new module, we need jugement the namespace whether in parent module\r\nexport function createModuleByNamespace (namespace, partialModule, rootModule, stringifyAction, createMsg) {\r\n  if (!namespace) {\r\n    return mergeModule(rootModule, partialModule)\r\n  }\r\n\r\n  let parentWraper = {}\r\n  let parentModule = rootModule\r\n  const moduleWraper = parentWraper\r\n  const segments = namespace.split('.')\r\n  const remaingMsg =  `\\n\\n  --- from [${stringifyAction}] action`\r\n\r\n  for (let i = 0, len = segments.length; i < len; i++) {\r\n    let childModule\r\n    const key = segments[i]\r\n    const isLastIndex = i === len - 1\r\n\r\n    // the global state certainly module\r\n    if (i > 0) {\r\n      assert(\r\n        isModule(parentModule),\r\n        'the child modules must be in the parent module.\\n\\n' +\r\n          `  the parent module namespace is [${segments[i - 1]}]\\n\\n` +\r\n            `  the child module namespace is [${key}]${remaingMsg}`, \r\n      )\r\n    }\r\n\r\n    if (key in parentModule) {\r\n      assert(\r\n        isModule(parentModule[key]),\r\n        'you can\\'t create child moudle, ' +\r\n          `because namespace [${key}] already exists in [${segments[i - 1] || 'root'}] module, ` +\r\n            `but [${key}] not a module.${remaingMsg}`,\r\n      )\r\n\r\n      // the parentModule is module\r\n      childModule = isLastIndex\r\n        ? mergeModule(parentModule[key], partialModule, key, createMsg)\r\n        : Object.assign({}, parentModule[key])\r\n    } else {\r\n      childModule = isLastIndex\r\n        ? createModule(partialModule)\r\n        : addModuleFlag({})\r\n    }\r\n\r\n    parentWraper[key] = childModule\r\n    parentWraper = childModule\r\n    parentModule = childModule\r\n  }\r\n\r\n  return moduleWraper\r\n}","export const ADD = 1\r\nexport const REMOVE = 2\r\nexport const REPLACE = 3\r\n\r\nfunction Patch (type, path, value, leftValue) {\r\n  this.type = type\r\n  this.path = path\r\n  this.value = value\r\n  this.leftValue = leftValue\r\n}\r\n\r\n// compare left and right values\r\nfunction diffValues (left, right, path, patchs) {\r\n  // filter functin and null\r\n  if (typeof left === 'function' || left === null) {\r\n    patchs.push(new Patch(REPLACE, path, right, left))\r\n  } else if (Array.isArray(left)) {\r\n    // diff array\r\n    if (Array.isArray(right)) {\r\n      walkArray(left, right, path, patchs)\r\n    } else {\r\n      patchs.push(new Patch(REPLACE, path, right, left))\r\n    }\r\n  } else if (typeof left === 'object') {\r\n    // diff object\r\n    if (\r\n        right !== null &&\r\n        typeof right === 'object' &&\r\n        !Array.isArray(right)\r\n    ) {\r\n      // filter Date object\r\n      if (left instanceof Date || right instanceof Date) {\r\n        patchs.push(new Patch(REPLACE, path, right, left))\r\n      } else {\r\n        walkObject(left, right, path, patchs)\r\n      }\r\n    } else {\r\n      patchs.push(new Patch(REPLACE, path, right, left))\r\n    }\r\n  } else {\r\n    patchs.push(new Patch(REPLACE, path, right, left))\r\n  }\r\n}\r\n\r\n// if array is `[1, 2, 3, a: dd]`, filter `a`\r\nfunction walkArray (a, b, base, patchs) {\r\n  if (a.length <= b.length) {\r\n    let len = a.length\r\n    while (~--len) {\r\n      if (a[len] !== b[len]) {\r\n        const path = `${base}[${len}]`\r\n        diffValues(a[len], b[len], path, patchs)\r\n      }\r\n    }\r\n  \r\n    if (b.length > a.length) {\r\n      len = b.length\r\n      while (--len >= a.length) {\r\n        const path = `${base}[${len}]`\r\n        patchs.push(new Patch(ADD, path, b[len], a[len]))\r\n      }\r\n    }\r\n  } else {\r\n    // if new list less than old list,\r\n    // no need diff, direct replace is fine.\r\n    patchs.push(new Patch(REPLACE, base, b, a))\r\n  }\r\n}\r\n\r\nfunction walkObject (a, b, base, patchs) {\r\n  // walk left object\r\n  for (const key in a) {\r\n    // current path\r\n    const path = `${base}.${key}`\r\n\r\n    if (!(key in b)) {\r\n      patchs.push(new Patch(REMOVE, path, null, a[key]))\r\n    } else if (a[key] !== b[key]) {\r\n      diffValues(a[key], b[key], path, patchs)\r\n\r\n      // don't use `delete` statement,\r\n      // will destroy the stability of the `object` structure\r\n      // delete b[key]\r\n    }\r\n  }\r\n\r\n  // walk right object\r\n  for (const key in b) {\r\n    if (!(key in a)) {\r\n      const path = `${base}.${key}`\r\n      patchs.push(new Patch(ADD, path, b[key], null))\r\n    }\r\n  }\r\n}\r\n\r\n// root `a` and root `b` is an object\r\nexport function diff (a, b, basePath) {\r\n  const patchs = []\r\n  walkObject(a, b, basePath, patchs)\r\n  return patchs\r\n}\r\n\r\nconst REG = /[^\\[\\].]+(?=[\\[\\].])/g\r\n\r\n// return target object\r\nfunction separatePath (obj, path) {\r\n  const keys = path.match(REG)\r\n\r\n  // delete first key\r\n  if (keys && keys.shift() && keys.length > 0) {\r\n    let i = -1\r\n    let key = null\r\n    let target = obj\r\n    let prevTarget = null\r\n\r\n    while (i++ < keys.length - 2) {\r\n      prevTarget = target\r\n      key = keys[i]\r\n      target = target[key]\r\n    }\r\n\r\n    return [target, key, prevTarget, keys[keys.length -1]]\r\n  }\r\n}\r\n\r\nexport function restore (obj, patchs) {\r\n  let len = patchs.length\r\n  const deleteEmptys = new Map()\r\n\r\n  while (~--len) {\r\n    const { type, path, leftValue } = patchs[len]\r\n    // use es5 reg\r\n    const parseItem = separatePath(obj, path + '.')\r\n\r\n    if (parseItem) {\r\n      const [target, key, prevTarget, lastKey] = parseItem\r\n\r\n      // reverse recovery\r\n      switch (type) {\r\n        case REMOVE :\r\n          target[lastKey] = leftValue\r\n          break\r\n        case REPLACE :\r\n          target[lastKey] = leftValue\r\n          break\r\n        case ADD :\r\n          if (Array.isArray(target) && target === prevTarget[key]) {\r\n            deleteEmptys.set(target, { key, prevTarget })\r\n          }\r\n          delete target[lastKey]\r\n          break\r\n      }\r\n    }\r\n  }\r\n\r\n  deleteEmptys.forEach(({ key, prevTarget }, target) => {\r\n    const clone = new target.constructor()\r\n    // filter empty item\r\n    target.forEach(item => clone.push(item))\r\n    prevTarget[key] = clone\r\n  })\r\n\r\n  return obj\r\n}","import { diff } from './diff'\r\nimport { callHook } from './utils'\r\n\r\nexport function applyPatchs (component, patchs, callback) {\r\n  const destObject = {}\r\n\r\n  for (let i = 0, len = patchs.length; i < len; i++) {\r\n    const { value, path } = patchs[i]\r\n    destObject[path] = value\r\n  }\r\n\r\n  component.setData(destObject, callback)\r\n}\r\n\r\n// update page and component\r\nexport function updateComponents (store, callback) {\r\n  let total = 0\r\n  const {\r\n    hooks,\r\n    GLOBALWORD,\r\n    depComponents,\r\n  } = store\r\n  const len = depComponents.length\r\n\r\n  if (len === 0) {\r\n    if (typeof callback === 'function') {\r\n      callback()\r\n    }\r\n    return\r\n  }\r\n\r\n  // call `callback`, when all component views are rendered\r\n  const renderedCallback = () => {\r\n    if (++total === len) {\r\n      if (typeof callback === 'function') {\r\n        callback()\r\n      }\r\n    }\r\n  }\r\n\r\n  for (let i = 0; i < len; i++) {\r\n    const {\r\n      isPage,\r\n      component,\r\n      didUpdate,\r\n      willUpdate,\r\n      createState,\r\n    } = depComponents[i]\r\n\r\n    if (component.data[GLOBALWORD]) {\r\n      const newPartialState = createState()\r\n\r\n      // the `willUpdate` function will optimize component\r\n      if (typeof willUpdate === 'function') {\r\n        if (willUpdate.call(store, component, newPartialState) === false) {\r\n          renderedCallback()\r\n          continue\r\n        }\r\n      }\r\n\r\n      // the base path is `GLOBALWORD`\r\n      // example: this.setData({ 'global.xx': xx })\r\n      const patchs = diff(component.data[GLOBALWORD], newPartialState, GLOBALWORD)\r\n\r\n      if (patchs.length > 0) {\r\n        // call global hooks\r\n        const params = [component, newPartialState, patchs, isPage]\r\n        if (callHook(hooks, 'willUpdate', params) === false) {\r\n          renderedCallback()\r\n          continue\r\n        }\r\n\r\n        // update component\r\n        applyPatchs(component, patchs, renderedCallback)\r\n\r\n        if (typeof didUpdate === 'function') {\r\n          didUpdate.call(store, component, newPartialState, patchs)\r\n        }\r\n        \r\n        callHook(hooks, 'didUpdate', [component, newPartialState, isPage])\r\n\r\n        // record patchs, allow playback view\r\n        if (component.timeTravel) {\r\n          component.timeTravel.push(patchs)\r\n        }\r\n      } else {\r\n        renderedCallback()\r\n      }\r\n    } else {\r\n      renderedCallback()\r\n    }\r\n  }\r\n}","import { applyPatchs } from './update'\r\nimport { diff, restore } from './diff'\r\nimport { warning, clone, assert } from './utils'\r\n\r\nexport default class TimeTravel {\r\n  constructor (component, GLOBALWORD, limit) {\r\n    this.history = []\r\n    this.limit = limit\r\n    this.component = component\r\n    this.GLOBALWORD = GLOBALWORD\r\n    this.length = this.history.length\r\n    this.current = this.history.length\r\n    this.finallyState = component.data[GLOBALWORD]\r\n  }\r\n\r\n  // only record diff patchs\r\n  // so, can't restore to the state at initialization\r\n  push (patchs) {\r\n    const {\r\n      limit,\r\n      history,\r\n      GLOBALWORD,\r\n      history: { length },\r\n      component: { data },\r\n    } = this\r\n\r\n    if (limit > 0) {\r\n      // if exceed the limit, should to remove the extra item\r\n      const extraCount = length - limit\r\n      if (extraCount >= 0) {\r\n        this.history.splice(0, extraCount + 1)\r\n      }\r\n\r\n      this.history.push(patchs)\r\n      this.length = history.length\r\n      this.current = history.length\r\n      // need deep clone state\r\n      this.finallyState = clone(data[GLOBALWORD])\r\n    }\r\n  }\r\n\r\n  go (n) {\r\n    const {\r\n      current,\r\n      history,\r\n      component,\r\n      GLOBALWORD,\r\n      finallyState,\r\n    } = this\r\n\r\n    assert(\r\n      GLOBALWORD in component.data,\r\n      'You can\\'t use [timeTravel] because it only works for [global state]',\r\n    )\r\n\r\n    if (this.limit > 0) {\r\n      if (n !== 0) {\r\n        const range = n + current\r\n        const backtrack = Math.abs(n)\r\n\r\n        if (range < 0 || range > history.length) {\r\n          warning(`Index [${range}] is not within the allowed range.`, true)\r\n          return\r\n        }\r\n\r\n        let index = 0\r\n        // deep clone patchs and state, we need keep state is immutable\r\n        let data = clone(component.data[GLOBALWORD])\r\n\r\n        while(index++ < backtrack) {\r\n          const id = current + Math.sign(n) * index\r\n          if (id < history.length) {\r\n            const patchs = clone(history[id])\r\n            data = restore(data, patchs)\r\n          } else {\r\n            data = finallyState\r\n          }\r\n        }\r\n\r\n        const endPatchs = diff(component.data[GLOBALWORD], data, GLOBALWORD)\r\n        if (endPatchs.length > 0) {\r\n          applyPatchs(component, endPatchs)\r\n        }\r\n\r\n        this.current += n\r\n      }\r\n    }\r\n  }\r\n\r\n  forward () {\r\n    this.go(1)\r\n  }\r\n\r\n  back () {\r\n    this.go(-1)\r\n  }\r\n\r\n  toStart () {\r\n    this.go(-this.current)\r\n  }\r\n\r\n  toEnd () {\r\n    this.go(this.history.length - this.current)\r\n  }\r\n}","import { warning, assert } from './utils'\r\n\r\nexport const COMMONACTION = () => {}\r\n\r\nfunction match (layer, action) {\r\n  if (layer.action === COMMONACTION) return true\r\n  return action === layer.action\r\n}\r\n\r\nfunction handleLayer (\r\n  action,\r\n  fn,\r\n  store,\r\n  payload,\r\n  next,\r\n  restoreProcessState,\r\n) {\r\n  try {\r\n    fn.call(store, payload, next, action)\r\n    restoreProcessState()\r\n  } catch (error) {\r\n    const hooks = store.hooks\r\n    restoreProcessState()\r\n\r\n    // if the error hook exist, don't throw error\r\n    if (hooks && typeof hooks['middlewareError'] === 'function') {\r\n      hooks['middlewareError'](action, payload, error)\r\n    } else {\r\n      warning(`${error}\\n\\n   --- from middleware [${action.toString()}] action.`)\r\n    }\r\n  }\r\n}\r\n\r\n// deal with all middleware\r\nexport class Middleware {\r\n  constructor (store) {\r\n    this.stack = []\r\n    this.store = store\r\n    this.isProcessing = false\r\n  }\r\n\r\n  use (action, fn) {\r\n    assert(\r\n      !this.isProcessing,\r\n      'can\\'t allow add new middleware in the middleware processing.'\r\n    )\r\n    this.stack.push({ fn, action })\r\n  }\r\n\r\n  remove (action, fn) {\r\n    const index = this.stack.findIndex(layer => {\r\n      return layer.fn === fn && layer.action === action\r\n    })\r\n\r\n    if (index > -1) {\r\n      this.stack.splice(index, 1)\r\n    }\r\n  }\r\n\r\n  process (action, payload, finish) {\r\n    // can't allow add new middleware in the middleware processing and setter function\r\n    this.isProcessing = true\r\n    const restoreProcessState = () => {\r\n      this.isProcessing = false\r\n    }\r\n\r\n    if (this.stack.length > 0) {\r\n      let index = 0\r\n      const next = prevPayload => {\r\n        let layer = this.stack[index]\r\n\r\n        index++\r\n\r\n        while (layer && !match(layer, action)) {\r\n          layer = this.stack[index++]\r\n        }\r\n\r\n        if (layer) {\r\n          // put `try catch` in a separate function,\r\n          // avoid the entire function not being optimized.\r\n          handleLayer(\r\n            action,\r\n            layer.fn,\r\n            this.store,\r\n            prevPayload,\r\n            next,\r\n            restoreProcessState,\r\n          )\r\n        } else {\r\n          finish(prevPayload, restoreProcessState)\r\n        }\r\n      }\r\n\r\n      next(payload)\r\n    } else {\r\n      finish(payload, restoreProcessState)\r\n    }\r\n  }\r\n}","import {\r\n  clone,\r\n  assert,\r\n  remove,\r\n  warning,\r\n  callHook,\r\n  mapObject,\r\n  mergeState,\r\n  deepFreeze,\r\n  createWraper,\r\n  isPlainObject,\r\n  isEmptyObject,\r\n} from './utils'\r\n\r\nimport {\r\n  getModule,\r\n  mergeModule,\r\n  createModule,\r\n  createModuleByNamespace,\r\n} from './module'\r\n\r\nimport { diff } from './diff'\r\nimport TimeTravel from './time-travel'\r\nimport { Middleware, COMMONACTION } from './middleware'\r\nimport { applyPatchs, updateComponents } from './update'\r\n\r\n// Each `store` instance has a unique id\r\nlet storeId = 0\r\n\r\nfunction assertReducer (action, reducer) {\r\n  const { setter, partialState } = reducer\r\n  const stringifyAction = action.toString()\r\n  const actionType = typeof action\r\n\r\n  assert(\r\n    typeof actionType === 'string' || typeof actionType === 'symbol',\r\n    `The action must be a Symbol or String, but now is [${actionType}].`,\r\n  )\r\n\r\n  assert(\r\n    'partialState' in reducer,\r\n    `You must defined [partialState].` + \r\n      `\\n\\n --- from [${stringifyAction}] action.`,\r\n  )\r\n\r\n  assert(\r\n    isPlainObject(partialState),\r\n    `The [partialState] must be an object.` +\r\n      `\\n\\n --- from [${stringifyAction}] action.`,\r\n  )\r\n\r\n  if (typeof setter !== 'function') {\r\n    reducer.setter = () => {\r\n      warning(\r\n        `Can\\'t changed [${stringifyAction}] action value. Have you defined a setter?` +\r\n          `\\n\\n --- from [${stringifyAction}] action.`\r\n      )\r\n    }\r\n  }\r\n  return reducer\r\n}\r\n\r\nfunction filterReducer (state, action, reducer) {\r\n  const stringifyAction = action.toString()\r\n  const { namespace, partialState } = reducer\r\n\r\n  if ('namespace' in reducer) {\r\n    assert(\r\n      typeof namespace === 'string',\r\n      'The module namespace must be a string.' +\r\n        `\\n\\n --- from [${stringifyAction}] action.`,\r\n    )\r\n    \r\n    if (!getModule(state, namespace) || !isEmptyObject(partialState)) {\r\n      reducer.partialState = createModuleByNamespace(\r\n        namespace,\r\n        partialState,\r\n        state,\r\n        stringifyAction,\r\n        (key, moduleName) => `The [${key}] already exists in [${moduleName}] module, ` +\r\n          `Please don't repeat defined. \\n\\n --- from [${stringifyAction}] action.`,\r\n      )\r\n    }\r\n  } else {\r\n    // inspect all state key \r\n    for (const key in partialState) {\r\n      assert(\r\n        !state.hasOwnProperty(key),\r\n        `The [${key}] already exists in global state, ` +\r\n          `Please don't repeat defined. \\n\\n --- from [${stringifyAction}] action.`,\r\n      )\r\n    }\r\n  }\r\n  return reducer\r\n}\r\n\r\nexport class Store {\r\n  constructor (hooks) {\r\n    this.hooks = hooks\r\n    this.reducers = []\r\n    this.id = ++storeId\r\n    this.depComponents = []\r\n    this.GLOBALWORD = 'global' // global state namespace\r\n    this.isDispatching = false\r\n    this.version = __VERSION__\r\n    this.state = Object.freeze(createModule({}))\r\n    this.middleware = new Middleware(this)\r\n  }\r\n\r\n  add (action, reducer) {\r\n    assert(\r\n      !this.reducers.find(v => v.action === action),\r\n      `Can't repeat defined [${action.toString()}] action.`,\r\n    )\r\n    \r\n    assertReducer(action, reducer)\r\n    filterReducer(this.state, action, reducer)\r\n\r\n    reducer.action = action\r\n    this.reducers.push(reducer)\r\n    const { partialState } = reducer\r\n\r\n    if (!isEmptyObject(partialState)) {\r\n      // because we don't allow duplicate fields to be created,\r\n      // so don't need to use `mergeModule`\r\n      this.state = mergeState(this.state, partialState)\r\n    }\r\n  }\r\n\r\n  dispatch (action, payload, callback) {\r\n    const { reducers, isDispatching } = this\r\n    const stringifyAction = action.toString()\r\n\r\n    // if we in call dispatch process,\r\n    // we don't allow call dispacth again.\r\n    assert(\r\n      !isDispatching,\r\n      'It is not allowed to call \"dispatch\" during dispatch execution.' +\r\n        `\\n\\n   --- from [${stringifyAction}] action.`\r\n    )\r\n\r\n    const reducer = reducers.find(v => v.action === action)\r\n\r\n    assert(\r\n      reducer,\r\n      `The [${stringifyAction}] action does not exist. ` +\r\n        'Maybe you have not defined.'\r\n    )\r\n\r\n    // call all middleware\r\n    this.middleware.process(action, payload, (destPayload, restoreProcessState) => {\r\n      this.isDispatching = true\r\n\r\n      try {\r\n        let newPartialState\r\n        const namespace = reducer.namespace\r\n        const isModuleDispatching = typeof namespace === 'string'\r\n\r\n        if (isModuleDispatching) {\r\n          // generate new partial state\r\n          const module = this.getModule(namespace, `\\n\\n --- from [${stringifyAction}] action.`)\r\n          newPartialState = reducer.setter(module, destPayload, this.state)\r\n        } else {\r\n          newPartialState = reducer.setter(this.state, destPayload)\r\n        }\r\n\r\n        assert(\r\n          isPlainObject(newPartialState),\r\n          'setter function should be return a plain object.',\r\n        )\r\n\r\n        // update global state\r\n        if (!isEmptyObject(newPartialState)) {\r\n          if (isModuleDispatching) {\r\n            // create new partialState and merge modules\r\n            newPartialState = createModuleByNamespace(\r\n              namespace,\r\n              newPartialState,\r\n              this.state,\r\n              stringifyAction,\r\n            )\r\n            this.state = mergeState(this.state, newPartialState)\r\n          } else {\r\n            this.state = deepFreeze(mergeModule(this.state, newPartialState))\r\n          }\r\n        }\r\n      } finally {\r\n        // the `isDispatching` need restore.\r\n         this.isDispatching = false\r\n        // restore state\r\n        restoreProcessState()\r\n      }\r\n\r\n      // update components\r\n      updateComponents(this, callback)\r\n    })\r\n  }\r\n\r\n  // add middleware\r\n  use (action, fn) {\r\n    if (\r\n      typeof action === 'function' &&\r\n      action !== COMMONACTION\r\n    ) {\r\n      fn = action\r\n      action = COMMONACTION\r\n    }\r\n\r\n    this.middleware.use(action, fn)\r\n    return () => this.middleware.remove(action, fn)\r\n  }\r\n\r\n  // allow change `GLOBALWORD`.\r\n  setNamespace (key) {\r\n    assert(\r\n      key && typeof key === 'string',\r\n      'The [namespace] must be a string',\r\n    )\r\n    this.GLOBALWORD = key\r\n  }\r\n\r\n  // get module\r\n  getModule (namespace, remainMsg) {\r\n    assert(\r\n      typeof namespace === 'string',\r\n      'the namespace mast be a string',\r\n    )\r\n\r\n    if (!namespace) {\r\n      return this.state\r\n    }\r\n\r\n    // deal with module state\r\n    const module = getModule(this.state, namespace)\r\n    // if the module does not meet the requirements\r\n    // throw error\r\n    if (remainMsg && module === null) {\r\n      warning(`The [${namespace}] module is not exist.${remainMsg || ''}`)\r\n    }\r\n    return module\r\n  }\r\n\r\n  addModule (namespace, reducers) {\r\n    assert(\r\n      typeof namespace === 'string',\r\n      'the namespace mast be a string',\r\n    )\r\n\r\n    if (!isEmptyObject(reducers)) {\r\n      let i = 0\r\n      const keys = Object.keys(reducers)\r\n      const symbols = Object.getOwnPropertySymbols(reducers)\r\n\r\n      const addRecucer = action => {\r\n        const reducer = reducers[action]\r\n        reducer.namespace = namespace\r\n        this.add(action, reducer)\r\n      }\r\n    \r\n      for (; i < keys.length; i++) {\r\n        addRecucer(keys[i])\r\n      }\r\n      \r\n      for (i = 0; i < symbols.length; i++) {\r\n        addRecucer(symbols[i])\r\n      }\r\n    }\r\n  }\r\n\r\n  // insert method\r\n  rewirteConfigAndAddDep (config, isPage) {\r\n    let createState = null\r\n    const store = this\r\n    const GLOBALWORD = this.GLOBALWORD\r\n    const { data, storeConfig = {} } = config\r\n    const {\r\n      useState,\r\n      didUpdate,\r\n      willUpdate,\r\n      defineReducer,\r\n      travelLimit = 0, // default not open time travel function\r\n    } = storeConfig\r\n\r\n    assert(\r\n      typeof travelLimit === 'number',\r\n      `[travelLimit] must be a number, but now is [${typeof travelLimit}].`\r\n    )\r\n\r\n    delete config.storeConfig\r\n\r\n    // this is a uitl method,\r\n    // allow craete reducer in the page or component.\r\n    if (typeof defineReducer === 'function') {\r\n      defineReducer.call(store, store)\r\n    }\r\n\r\n    // get the global state words used\r\n    if (typeof useState === 'function') {\r\n      let namespace = null\r\n      let defineObject = null\r\n      const useConfig = useState.call(store, store)\r\n\r\n      // inspect should need module state\r\n      if (Array.isArray(useConfig)) {\r\n        namespace = useConfig[0]\r\n        defineObject = useConfig[1]\r\n      } else {\r\n        defineObject = useConfig\r\n      }\r\n\r\n      assert(\r\n        isPlainObject(defineObject),\r\n        '[useState] must return a plain object, ' +\r\n          `but now is return a [${typeof defineObject}]`,\r\n      )\r\n      \r\n      // need deep clone, otherwise the `data.global` on the back of the component cannot be changed.\r\n      createState = () => clone(mapObject(defineObject, fn => {\r\n        if (namespace === null) {\r\n          return fn(store.state)\r\n        }\r\n        const module = this.getModule(namespace, `\\n\\n   --- from [${namespace}] of useState.`)\r\n        return fn(module, store.state)\r\n      }))\r\n    }\r\n\r\n    // get state used by the current component\r\n    if (createState !== null) {\r\n      const useState = createState()\r\n      if (isPlainObject(useState)) {\r\n        data \r\n          ? data[GLOBALWORD] = useState\r\n          : config.data = { [GLOBALWORD]: useState }\r\n      }\r\n    }\r\n\r\n    const addDep = component => {\r\n      const shouldAdd = callHook(this.hooks, 'addDep', [component, isPage])\r\n\r\n      // if no used global state word,\r\n      // no need to add dependencies.\r\n      if (shouldAdd !== false && createState !== null) {\r\n        if (component.data && isPlainObject(component.data[GLOBALWORD])) {\r\n          // time travel can record diff patchs\r\n          component.timeTravel = new TimeTravel(component, GLOBALWORD, travelLimit)\r\n\r\n          // add component to depComponents\r\n          this.depComponents.push({\r\n            isPage,\r\n            component,\r\n            didUpdate,\r\n            willUpdate,\r\n            createState,\r\n          })\r\n\r\n          // if the global state is changed, need update component\r\n          const patchs = diff(component.data[GLOBALWORD], createState(), GLOBALWORD)\r\n          if (patchs.length > 0) {\r\n            applyPatchs(component, patchs, GLOBALWORD)\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isPage) {\r\n      config.onLoad = createWraper(\r\n        config.onLoad,\r\n        function () {\r\n          addDep(this)\r\n          // rigister store to component within\r\n          this.store = store\r\n        },\r\n      )\r\n      \r\n      config.onUnload = createWraper(\r\n        config.onUnload,\r\n        null,\r\n        function () {\r\n          // clear cache\r\n          remove(store.depComponents, this)\r\n        },\r\n      )\r\n    } else {\r\n      // Component\r\n      config.lifetimes = config.lifetimes || {}\r\n      const get = name => config[name] || config.lifetimes[name]\r\n      const set = (name, fn) => config[name] = config.lifetimes[name] = fn\r\n\r\n      set('attached', createWraper(\r\n        get('attached'),\r\n        function () {\r\n          addDep(this)\r\n          this.store = store\r\n        },\r\n      ))\r\n\r\n      set('detached', createWraper(\r\n        get('detached'),\r\n        null,\r\n        function () {\r\n          remove(store.depComponents, this)\r\n        },\r\n      ))\r\n    }\r\n  }\r\n}","import {\r\n  callHook,\r\n  mixinMethods,\r\n  createWraper,\r\n  isEmptyObject,\r\n} from './utils'\r\nimport mixin from './mixin'\r\nimport { Store } from './store'\r\nexport { clone } from './utils'\r\nexport { diff, restore } from './diff'\r\nexport { isModule, createModule } from './module'\r\n\r\nexport const version = __VERSION__\r\n\r\nconst nativePage = Page\r\nconst nativeComponent = Component\r\n\r\nfunction expandConfig (config, expandMethods, isPage) {\r\n  if (!isEmptyObject(expandMethods)) {\r\n    if (isPage) {\r\n      mixinMethods(config, expandMethods)\r\n    } else {\r\n      config.methods = config.methods || {}\r\n      mixinMethods(config.methods, expandMethods)\r\n    }\r\n  }\r\n}\r\n\r\nexport default function (mixinInject, hooks) {\r\n  const store = new Store(hooks)\r\n  const expandMethods = mixin(mixinInject)\r\n\r\n  // we can rewirte Page and Component function\r\n  // this will be better compatible with previous project\r\n  Page = createWraper(\r\n    nativePage,\r\n    function (config) {\r\n      // we allow add additional config attributes\r\n      callHook(hooks, 'createBefore', [config, true])\r\n\r\n      expandConfig(config, expandMethods, true)\r\n    \r\n      // the store will record all page and component\r\n      // when global state changed, the dependent components will be update\r\n      store.rewirteConfigAndAddDep(config, true)\r\n    },\r\n  )\r\n\r\n  Component = createWraper(\r\n    nativeComponent,\r\n    function (config) {\r\n      callHook(hooks, 'createBefore', [config, false])\r\n\r\n      expandConfig(config, expandMethods, false)\r\n      store.rewirteConfigAndAddDep(config, false)\r\n    },\r\n  )\r\n\r\n  return store\r\n}"],"names":["warning","message","noError","console","warn","Error","assert","condition","isPrimitive","value","deepFreeze","state","names","Object","getOwnPropertyNames","len","length","freeze","mergeState","oldState","newState","assign","mixinMethods","config","methods","key","remove","list","component","index","findIndex","item","splice","callHook","hooks","name","args","apply","isEmptyObject","obj","k","mapObject","fn","destObject","hasOwnProperty","createWraper","target","before","after","result","isPlainObject","proto","getPrototypeOf","baseProto","clone","record","WeakMap","undefined","Date","has","get","constructor","create","set","parsePath","path","segments","split","i","inject","expandMethods","callback","MODULE_FLAG","Symbol","isModule","m","getModule","namespace","module","mergeModule","partialModule","moduleName","createMsg","keys","originItem","currentPartialItem","isModuleForOrigin","isModuleForCurrent","createModule","addModuleFlag","createModuleByNamespace","rootModule","stringifyAction","parentWraper","parentModule","moduleWraper","remaingMsg","childModule","isLastIndex","ADD","REMOVE","REPLACE","Patch","type","leftValue","diffValues","left","right","patchs","push","Array","isArray","walkArray","walkObject","a","b","base","diff","basePath","REG","separatePath","match","shift","prevTarget","restore","deleteEmptys","Map","parseItem","lastKey","forEach","applyPatchs","setData","updateComponents","store","total","GLOBALWORD","depComponents","renderedCallback","isPage","didUpdate","willUpdate","createState","data","newPartialState","call","params","timeTravel","TimeTravel","limit","history","current","finallyState","extraCount","n","range","backtrack","Math","abs","id","sign","endPatchs","go","COMMONACTION","layer","action","handleLayer","payload","next","restoreProcessState","error","toString","Middleware","stack","isProcessing","finish","prevPayload","storeId","assertReducer","reducer","setter","partialState","actionType","filterReducer","Store","reducers","isDispatching","version","__VERSION__","middleware","find","v","process","destPayload","isModuleDispatching","use","remainMsg","symbols","getOwnPropertySymbols","addRecucer","add","storeConfig","useState","defineReducer","travelLimit","defineObject","useConfig","addDep","shouldAdd","onLoad","onUnload","lifetimes","nativePage","Page","nativeComponent","Component","expandConfig","mixinInject","mixin","rewirteConfigAndAddDep"],"mappings":"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"}